---
layout: post
title: Malware Static Analysis - Malbuster
subtitle: Discover malware and its associated information by inspecting the source code of an unknown binary using various tools.
date: 2024-11-20 16:07
author: Ren Sie
comments: true
category: malware-analysis
---

{: .box-success}
 Refer to [Malbuster](https://tryhackme.com/r/room/malbuster) for the challenge room on TryHackMe

<!-- wp:heading {"level":1,"style":{"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}},"fontSize":"large"} -->
<h1 class="wp-block-heading has-text-color has-link-color has-large-font-size" style="color:#74103e">Scenario</h1>
<!-- /wp:heading -->

<!-- wp:paragraph {"align":"justify","fontSize":"small"} -->
<p class="has-text-align-justify has-small-font-size">As a Malware Reverse Engineer. Our team supports the SOC team when unknown binaries are detected. A SOC analyst found an alert triggered by suspicious binaries. Our job is to analyze these binaries and provide information to help the SOC team handle the threat.<br>Lastly, find the malware samples on C:\Users\Administrator\Desktop\Samples.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":1,"style":{"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}},"fontSize":"large"} -->
<h1 class="wp-block-heading has-text-color has-link-color has-large-font-size" style="color:#74103e">Tools</h1>
<!-- /wp:heading -->

<!-- wp:list -->
<ul class="wp-block-list"><!-- wp:list-item {"fontSize":"small"} -->
<li class="has-small-font-size"><a href="https://www.winitor.com/">PEstudio</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item {"fontSize":"small"} -->
<li class="has-small-font-size"><a href="https://www.virustotal.com/">VirusTotal</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item {"fontSize":"small"} -->
<li class="has-small-font-size"><a href="https://bazaar.abuse.ch/">Malware Bazaar</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item {"fontSize":"small"} -->
<li class="has-small-font-size"><a href="https://github.com/blackberry/pe_tree">PE-Tree</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item {"fontSize":"small"} -->
<li class="has-small-font-size"><a href="https://github.com/mandiant/flare-floss">Floss</a></li>
<!-- /wp:list-item -->

<!-- wp:list-item {"fontSize":"small"} -->
<li class="has-small-font-size"><a href="https://github.com/mandiant/capa">Capa</a></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:heading {"level":1,"style":{"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}},"fontSize":"large"} -->
<h1 class="wp-block-heading has-text-color has-link-color has-large-font-size" style="color:#74103e">Tasks</h1>
<!-- /wp:heading -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">Based on the ARCHITECTURE of the binary, is malbuster_1 a 32-bit or a 64-bit application?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"fontSize":"small"} -->
<p class="has-small-font-size">Open the file with PE-studio to find its CPU architecture.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3652,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-6.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-6.png?w=1024" alt="" class="wp-image-3652" /></a></figure>
<!-- /wp:image -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">What is the MD5 hash of malbuster_1?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"fontSize":"small"} -->
<p class="has-small-font-size">Refer to the previous screenshot.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">What is the number of detections of malbuster_1 in VirusTotal?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"fontSize":"small"} -->
<p class="has-small-font-size">Upload the MD5 hash value of malbuster_1 to <a href="https://www.virustotal.com/gui/file/000415d1c7a7a838ba2ef00874e352e8b43a57e2f98539b5908803056f883176">VirusTotal</a> and check the report.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3655,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-7.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-7.png?w=1024" alt="" class="wp-image-3655" /></a></figure>
<!-- /wp:image -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">What is the malware signature of malbuster_2 according to Avira?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"fontSize":"small"} -->
<p class="has-small-font-size">Firstly, retrieve the MD5 hash value of malbuster_2 with certutil.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"align":"justify","backgroundColor":"tertiary","fontSize":"small"} -->
<p class="has-text-align-justify has-tertiary-background-color has-background has-small-font-size"><kbd>C:\Users\Desktop\Samples&gt;certutil -hashfile malbuster_2 MD5</kbd></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3657,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-8.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-8.png?w=966" alt="" class="wp-image-3657" /></a></figure>
<!-- /wp:image -->

<!-- wp:paragraph {"align":"justify","fontSize":"small"} -->
<p class="has-text-align-justify has-small-font-size">Search retrieved the MD5 hash on <a href="https://www.virustotal.com/gui/file/ace3a5e5849c1c00760dfe67add397775f5946333357f5f8dee25cd4363e36b6">VirusTotal</a> and check the report from Avira under the DETECTION tab.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3658,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-9.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-9.png?w=891" alt="" class="wp-image-3658" /></a></figure>
<!-- /wp:image -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">From which DLL file does malbuster_2 import function _CorExeMain?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"align":"justify","fontSize":"small"} -->
<p class="has-text-align-justify has-small-font-size">Open the file with PEstudio, find the function on the Functions tab, and identify the DLL file that imports it.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3659,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-10.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-10.png?w=960" alt="" class="wp-image-3659" /></a></figure>
<!-- /wp:image -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">What is the original name of malbuster_2?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"align":"justify","fontSize":"small"} -->
<p class="has-text-align-justify has-small-font-size">Open the file with PEstudio, found the original filename of malbuster_2 on the Version tab.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3660,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-11.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-11.png?w=873" alt="" class="wp-image-3660" /></a></figure>
<!-- /wp:image -->

{: .box-note}
**Note:** The VERSION tab shows the version information embedded within the PE file, such as the. This data is stored in the file's version resource section. It is useful for detecting tampered or suspicious files, as malware may disguise itself.

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">What is its malware signature of malbuster_3 based on abuse.ch?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"fontSize":"small"} -->
<p class="has-small-font-size">Firstly, retrieve the MD5 hash value of malbuster_3 with certutil</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"align":"justify","backgroundColor":"tertiary","fontSize":"small"} -->
<p class="has-text-align-justify has-tertiary-background-color has-background has-small-font-size"><kbd>C:\Users\Desktop\Samples&gt;certutil -hashfile malbuster_3 MD5</kbd></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"fontSize":"small"} -->
<p class="has-small-font-size">Then, search the hash value on <a href="https://bazaar.abuse.ch/sample/9da8a5a0b5957db6112e927b607a8fd062b870f2132c4ae3442eb63235f789e1/">Malware Bazaar</a> to find the file signature.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3662,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-12.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-12.png?w=1024" alt="" class="wp-image-3662" /></a></figure>
<!-- /wp:image -->

{: .box-note}
**Note:** Trickbot is a banking Trojan that is often used to steal personal and financial data, as well as to deliver ransomware. It spreads through phishing campaigns and is known for its ability to evade detection by using advanced techniques and exploiting network vulnerabilities.

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">What is its malware signature of malbuster_4 based on abuse.ch?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"fontSize":"small"} -->
<p class="has-small-font-size">Following the same approach as the previous task for the file signature.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3663,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-13.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-13.png?w=1024" alt="" class="wp-image-3663" /></a></figure>
<!-- /wp:image -->

{: .box-note}
**Note:** Zloader primarily functions as a banking trojan, often used to steal sensitive information like login credentials and financial data. It is commonly spread through phishing emails and can deliver additional payloads, including ransomware, by exploiting system vulnerabilities.

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">What is the message in the DOS_STUB of malbuster_4?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"fontSize":"small"} -->
<p class="has-small-font-size">Use PE-Tree to view the DOS_STUB header and find the message.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"align":"justify","backgroundColor":"tertiary","fontSize":"small"} -->
<p class="has-text-align-justify has-tertiary-background-color has-background has-small-font-size"><kbd>~/Desktop/Samples$ pe-tree malbuster_4</kbd></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3665,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-14.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-14.png?w=1024" alt="" class="wp-image-3665" /></a></figure>
<!-- /wp:image -->

{: .box-note}
**Note:** The DOS STUB is a small piece of code that runs only if the PE file is incompatible with the system it’s being executed on.

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">From which DLL file does malbuster_4 import function ShellExecuteA?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"align":"justify","fontSize":"small"} -->
<p class="has-text-align-justify has-small-font-size">Upload the malbuster_4 hash to VirusTotal and find the function in the DETAILS tab, under the Imports section.</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3666,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-15.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-15.png?w=875" alt="" class="wp-image-3666" /></a></figure>
<!-- /wp:image -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">How many anti-VM instructions were identified in malbuster_1?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"fontSize":"small"} -->
<p class="has-small-font-size">Export the result from the Capa utility and use the search function to find the answer.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"align":"justify","backgroundColor":"tertiary","fontSize":"small"} -->
<p class="has-text-align-justify has-tertiary-background-color has-background has-small-font-size"><kbd>C:\Users\Desktop\Samples&gt; capa malbuster_1 &gt; Output_1.txt</kbd></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3667,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-16.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-16.png?w=1024" alt="" class="wp-image-3667" /></a></figure>
<!-- /wp:image -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">Which binary can log keystrokes?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"align":"justify","fontSize":"small"} -->
<p class="has-text-align-justify has-small-font-size">After using the capa on each binary, we will be able to identify which binary contains keylogger functions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"align":"justify","backgroundColor":"tertiary","fontSize":"small"} -->
<p class="has-text-align-justify has-tertiary-background-color has-background has-small-font-size"><kbd>C:\Users\Desktop\Samples&gt; capa &lt;Binary&gt; &gt; Output_Binary.txt</kbd></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3668,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-17.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-17.png?w=1024" alt="" class="wp-image-3668" /></a></figure>
<!-- /wp:image -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">What is the MITRE ID of the DISCOVERY technique used by malbuster_4?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"fontSize":"small"} -->
<p class="has-small-font-size">Export the result from the Capa utility and use the search function to find the answer.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"align":"justify","backgroundColor":"tertiary","fontSize":"small"} -->
<p class="has-text-align-justify has-tertiary-background-color has-background has-small-font-size"><kbd>C:\Users\Desktop\Samples&gt; capa malbuster_4 &gt; Output_4.txt</kbd></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3671,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-18.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-18.png?w=1024" alt="" class="wp-image-3671" /></a></figure>
<!-- /wp:image -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">Which binary contains the string GodMode?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"align":"justify","fontSize":"small"} -->
<p class="has-text-align-justify has-small-font-size">Run floss on each binary and pipe it with findstr for the keyword to identify which binary contains the string "GodMode."</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph {"align":"justify","backgroundColor":"tertiary","fontSize":"small"} -->
<p class="has-text-align-justify has-tertiary-background-color has-background has-small-font-size"><kbd>C:\Users\Desktop\Samples&gt; floss malbuster_ | findstr /i "GodMode"</kbd></p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3672,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-19.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-19.png?w=1024" alt="" class="wp-image-3672" /></a></figure>
<!-- /wp:image -->

<!-- wp:heading {"style":{"typography":{"fontSize":"1.5rem"},"color":{"text":"#74103e"},"elements":{"link":{"color":{"text":"#74103e"}}}}} -->
<h2 class="wp-block-heading has-text-color has-link-color" style="color:#74103e;font-size:1.5rem">Which binary contains the string Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph {"align":"justify","fontSize":"small"} -->
<p class="has-text-align-justify has-small-font-size">Run floss on each binary and pipe it with findstr for the keyword to identify which binary contains the string " Mozilla/4.0".</p>
<!-- /wp:paragraph -->

<!-- wp:image {"id":3673,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-20.png"><img src="https://1earnwithren.wordpress.com/wp-content/uploads/2024/11/image-20.png?w=1024" alt="" class="wp-image-3673" /></a></figure>
<!-- /wp:image -->

